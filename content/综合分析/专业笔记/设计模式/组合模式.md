---
title: ç»„åˆæ¨¡å¼
publish: true
---

## ä¸€ã€å‰è¨€

å¾€å¾€å¾ˆå¤šå¤§éœ€æ±‚éƒ½æ˜¯é€šè¿‡å¢åˆ æ”¹æŸ¥å †å‡ºæ¥çš„ï¼Œä»Šå¤©è¦ä¸€ä¸ªéœ€æ±‚ `if` ä¸€ä¸‹ï¼Œæ˜å¤©åŠ ä¸ªå†…å®¹ `else` æ‰©å±•ä¸€ä¸‹ã€‚æ—¥ç§¯æœˆç´¯éœ€æ±‚ä¹Ÿå°±è¶Šæ¥è¶Šå¤§ï¼Œæ‰©å±•å’Œç»´æŠ¤çš„æˆæœ¬ä¹Ÿå°±è¶Šæ¥è¶Šé«˜ã€‚å¾€å¾€å¤§éƒ¨åˆ†ç ”å‘æ˜¯ä¸å…·å¤‡äº§å“æ€ç»´å’Œæ•´ä½“ä¸šåŠ¡éœ€æ±‚å¯¼å‘çš„ï¼Œæ€»ä»¥ä¸ºå†™å¥½ä»£ç å®ŒæˆåŠŸèƒ½å³å¯ã€‚ä½†è¿™æ ·çš„ä¸è€ƒè™‘æ‰©å±•æ€§çš„å®ç°ï¼Œå¾ˆéš¾è®©åç»­çš„éœ€æ±‚éƒ½å¿«é€Ÿè¿­ä»£ï¼Œä¹…è€Œä¹…ä¹‹å°±ä¼šè¢«é™·å…¥æ¶æ€§å¾ªç¯ï¼Œæ¯å¤©éƒ½æœ‰ bug è¦æ”¹ã€‚

## äºŒã€ç»„åˆæ¨¡å¼ä»‹ç»

![[Pasted image 20241015113304.png]]

ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°è¿™æœ‰ç‚¹åƒèºä¸ğŸ”©å’Œèºæ¯ï¼Œé€šè¿‡ä¸€å †çš„é“¾æ¥ç»„ç»‡å‡ºä¸€æ£µç»“æ„æ ‘ã€‚è€Œè¿™ç§é€šè¿‡æŠŠç›¸ä¼¼å¯¹è±¡ (*ä¹Ÿå¯ä»¥ç§°ä½œæ˜¯æ–¹æ³•*) ç»„åˆæˆä¸€ç»„å¯è¢«è°ƒç”¨çš„ç»“æ„æ ‘å¯¹è±¡çš„è®¾è®¡æ€è·¯å«åšç»„åˆæ¨¡å¼ã€‚

è¿™ç§è®¾è®¡æ–¹å¼å¯ä»¥è®©ä½ çš„æœåŠ¡ç»„èŠ‚ç‚¹è¿›è¡Œè‡ªç”±ç»„åˆå¯¹å¤–æä¾›æœåŠ¡ï¼Œä¾‹å¦‚ä½ æœ‰ä¸‰ä¸ªåŸå­æ ¡éªŒåŠŸèƒ½ (`Aï¼šèº«ä»½è¯`ã€`Bï¼šé“¶è¡Œå¡`ã€`Cï¼šæ‰‹æœºå·`) æœåŠ¡å¹¶å¯¹å¤–æä¾›è°ƒç”¨ä½¿ç”¨ã€‚æœ‰äº›è°ƒç”¨æ–¹éœ€è¦ä½¿ç”¨ AB ç»„åˆï¼Œæœ‰äº›è°ƒç”¨æ–¹éœ€è¦ä½¿ç”¨åˆ° CBA ç»„åˆï¼Œè¿˜æœ‰ä¸€äº›å¯èƒ½åªä½¿ç”¨ä¸‰è€…ä¸­çš„ä¸€ä¸ªã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä½ å°±å¯ä»¥ä½¿ç”¨ç»„åˆæ¨¡å¼è¿›è¡Œæ„å»ºæœåŠ¡ï¼Œå¯¹äºä¸åŒç±»å‹çš„è°ƒç”¨æ–¹é…ç½®ä¸åŒçš„ç»„ç»‡å…³ç³»æ ‘ï¼Œè€Œè¿™ä¸ªæ ‘ç»“æ„ä½ å¯ä»¥é…ç½®åˆ°æ•°æ®åº“ä¸­ä¹Ÿå¯ä»¥ä¸æ–­çš„é€šè¿‡å›¾å½¢ç•Œé¢æ¥æ§åˆ¶æ ‘ç»“æ„ã€‚

æ‰€ä»¥ä¸åŒçš„è®¾è®¡æ¨¡å¼ç”¨åœ¨æ°å½“å¥½å¤„çš„åœºæ™¯å¯ä»¥è®©ä»£ç é€»è¾‘éå¸¸æ¸…æ™°å¹¶æ˜“äºæ‰©å±•ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å‡å°‘å›¢é˜Ÿæ–°å¢äººå‘˜å¯¹é¡¹ç›®çš„å­¦ä¹ æˆæœ¬ã€‚

## ä¸‰ã€æ¡ˆä¾‹åœºæ™¯æ¨¡æ‹Ÿ

![[Pasted image 20241015113351.png]]

ä»¥ä¸Šæ˜¯ä¸€ä¸ªéå¸¸ç®€åŒ–ç‰ˆçš„è¥é”€è§„åˆ™ `å†³ç­–æ ‘`ï¼Œæ ¹æ® `æ€§åˆ«`ã€`å¹´é¾„` æ¥å‘æ”¾ä¸åŒç±»å‹çš„ä¼˜æƒ åˆ¸ï¼Œæ¥åˆºæ¿€æ¶ˆè´¹èµ·åˆ°ç²¾å‡†ç”¨æˆ·ä¿ƒæ´»çš„ç›®çš„ã€‚

è™½ç„¶ä¸€éƒ¨åˆ†å°ä¼™ä¼´å¯èƒ½å¹¶æ²¡æœ‰å¼€å‘è¿‡è¥é”€åœºæ™¯ï¼Œä½†ä½ å¯èƒ½æ—¶æ—¶åˆ»åˆ»çš„è¢«è¥é”€ç€ã€‚æ¯”å¦‚ä½ å»ç»å¸¸æµè§ˆç”·æ€§å–œæ¬¢çš„æœºæ¢°é”®ç›˜ã€ç¬”è®°æœ¬ç”µè„‘ã€æ±½è½¦è£…é¥°ç­‰ç­‰ï¼Œé‚£ä¹ˆå°±ç»™ä½ æ¨èæ­¤ç±»çš„ä¼˜æƒ åˆ¸åˆºæ¿€ä½ æ¶ˆè´¹ã€‚é‚£ä¹ˆå¦‚æœä½ è´­ç‰©ä¸å¤šï¼Œæˆ–è€…é’±ä¸åœ¨è‡ªå·±æ‰‹é‡Œã€‚é‚£ä¹ˆä½ æ˜¯å¦æ‰“è¿‡è½¦ï¼Œæœ‰ä¸€æ®µæ—¶é—´ç»å¸¸æœ‰å°ä¼™ä¼´å–Šï¼Œä¸ºä»€ä¹ˆåŒæ ·çš„è·ç¦»ä»–å°± 10 å…ƒï¼Œæˆ‘å°± 15 å…ƒå‘¢ï¼Ÿå…¶å®è¿™äº›éƒ½æ˜¯è¢«è¥é”€çš„æ¡ˆä¾‹ï¼Œä¸€èˆ¬å¯¹äºä¸å¸¸ä½¿ç”¨è½¯ä»¶çš„å°ä¼™ä¼´ï¼Œç»å¸¸ä¼šè¿›è¡Œç¨å¾®å¤§åŠ›åº¦çš„ä¿ƒæ´»ï¼Œå¢åŠ ç”¨æˆ·ç²˜æ€§ã€‚

é‚£ä¹ˆåœ¨è¿™é‡Œæˆ‘ä»¬å°±æ¨¡æ‹Ÿä¸€ä¸ªç±»ä¼¼çš„å†³ç­–åœºæ™¯ï¼Œä½“ç°å‡ºç»„åˆæ¨¡å¼åœ¨å…¶ä¸­èµ·åˆ°çš„é‡è¦æ€§ã€‚å¦å¤–ï¼Œç»„åˆæ¨¡å¼ä¸åªæ˜¯å¯ä»¥è¿ç”¨äºè§„åˆ™å†³ç­–æ ‘ï¼Œè¿˜å¯ä»¥åšæœåŠ¡åŒ…è£…å°†ä¸åŒçš„æ¥å£è¿›è¡Œç»„åˆé…ç½®ï¼Œå¯¹å¤–æä¾›æœåŠ¡èƒ½åŠ›ï¼Œå‡å°‘å¼€å‘æˆæœ¬ã€‚

## å››ã€ç”¨åŸå§‹ä»£ç å®ç°

```java
public class EngineController {

    private Logger logger = LoggerFactory.getLogger(EngineController.class);

    public String process(final String userId, final String userSex, final int userAge) {

        logger.info("ifelseå®ç°æ–¹å¼åˆ¤æ–­ç”¨æˆ·ç»“æœã€‚userIdï¼š{} userSexï¼š{} userAgeï¼š{}", userId, userSex, userAge);

        if ("man".equals(userSex)) {
            if (userAge < 25) {
                return "æœå®A";
            }

            if (userAge >= 25) {
                return "æœå®B";
            }
        }

        if ("woman".equals(userSex)) {
            if (userAge < 25) {
                return "æœå®C";
            }

            if (userAge >= 25) {
                return "æœå®D";
            }
        }

        return null;

    }

}
```

## äº”ã€ç»„åˆæ¨¡å¼é‡æ„ä»£ç 

æ¥ä¸‹æ¥ä½¿ç”¨ç»„åˆæ¨¡å¼æ¥è¿›è¡Œä»£ç ä¼˜åŒ–ï¼Œä¹Ÿç®—æ˜¯ä¸€æ¬¡å¾ˆå°çš„é‡æ„ã€‚

æ¥ä¸‹æ¥çš„é‡æ„éƒ¨åˆ†ä»£ç æ”¹åŠ¨é‡ç›¸å¯¹æ¥è¯´ä¼šæ¯”è¾ƒå¤§ä¸€äº›ï¼Œä¸ºäº†è®©æˆ‘ä»¬å¯ä»¥æŠŠä¸åŒç±»å‹çš„å†³ç­–èŠ‚ç‚¹å’Œæœ€ç»ˆçš„æœå®ç»„è£…æˆä¸€æ£µå¯è¢«è¿è¡Œçš„å†³ç­–æ ‘ï¼Œéœ€è¦åšé€‚é…è®¾è®¡å’Œå·¥å‚æ–¹æ³•è°ƒç”¨ï¼Œå…·ä½“ä¼šä½“ç°åœ¨å®šä¹‰æ¥å£ä»¥åŠæŠ½è±¡ç±»å’Œåˆå§‹åŒ–é…ç½®å†³ç­–èŠ‚ç‚¹ï¼ˆæ€§åˆ«ã€å¹´é¾„ï¼‰ä¸Šã€‚å»ºè®®è¿™éƒ¨åˆ†ä»£ç å¤šé˜…è¯»å‡ æ¬¡ï¼Œæœ€å¥½å®è·µä¸‹ã€‚

### 0. å›¾ç¤º

[Flowchart Maker & Online Diagram Software](https://viewer.diagrams.net/?tags=%7B%7D&highlight=0000ff&edit=_blank&layers=1&nav=1&title=%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F.drawio#R7V1bc9s4sv41rHIe7OL98ijK8iRnnZmpJOfs7NMpWqIlbmhRS1GxPb9%2BcRdAgNSNpCiZqZlEvJPoD92NRvcHzRq%2FvP2WR6vF12wWp5qpz940614zTcsLdPAP3POO9xieZeM98zyZkX3bHd%2BTv2Oyk1w43ySzeC2cWGRZWiQrcec0Wy7jaSHsi%2FI8exVPe85S8amraB5LO75Po1Te%2B89kVizwXt%2F0tvs%2Fx8l8QZ9suAE%2B8hLRk8mXrBfRLHvldlkTzRrnWVbgXy9v4ziFrUfbBV%2F3UHGUvVgeL4t9LnAm5tf8q7N0Rutvv799%2F2v25%2Fgft%2BQuv6J0Qz74MZsn04ckLeKcvHfxThtj%2FZq8pNESbIWvi6SIv6%2BiKTz0CoQP9i2KlxRsGeAnuW2cF%2FFb5fsarBUAfuLsJS7yd3AKucAh7UaQY7tk%2B3UrBps29oIXgU1OjIjo5%2BzW29YBP0gDHdBYptRY8H7wP12bBJqva2GoTXwtnGiBoU0czXe10NImnja61wIX7gkCbeRrppuClw2fQAu7c%2FjrMVvOITpRs998L%2FIEbQMMge3%2FQ88zwTvrj8m6ANdEL7C50T1%2B5HH8O%2Bh2j8nyJzuC7gl7yvZg%2FGX5nMHLPzHpcIIFUipEAUZpMl%2BC32n8DI9ASSagV4zI7pdkNoMXh3m8Tv6OntCNdLC9ypJlgRreCTXnHt5pU2Rr3K%2FhjddFnv2Mx1ma5WDPMkNoAh%2BelnbthaBqTFfCKhBR5cigoqqHB1VrmLLqMOVr%2FkQLPQSlB4IgGVMQd2MZUyoU3RCgQWB8mWFMsfM26zinO7%2BCDi3gjJ7FX1FC2yyeJuskW35FzxtwxuMsUODM7RJnriSLeAYMHdnM8mKRzbNllE62e8M82yxn8Yy0%2BPacxyxbkVb%2Bd1wU78RqQwGIwo3fkuIvcjn8%2FS%2Fu9%2F0bv%2FFON5bgY%2F%2FiN%2F5F7wU3thehLXrVLFov0HtuTQ%2F8unrDAxoj2%2BTTuKbRiKtSRPk8PgIJeZxGRfJLfI%2FGJevJGgQohRGwQROoJqAG0ZXCf4yegLem7I1T0FTA%2Fp%2FUHys7FnHVyMVbB2lnh3NrO9ytfqcbNtGnezc9ud2f8PW5U7Ln5zUQeVk27KnHi8uWxBVG6xh5Xb3yt1xP9recQOFvOUZbOstR2EZs5WbJL2rmNFv%2FA3w3GDzE9Ch4GH%2BCfM1q85TC5tbb97t%2BYp8LYNwL934%2FdsPl03qFb6ncxTufhubfI29gAl0EhaPgaiMd%2BaUP0F3wx%2FAcoBnwySE4x0JXBfQ%2ByKuY2FqIvJC6G6JzwE5wKBhpvo0cXR39ANeCPSZSRKYWBsg9Bq4M8pNHBnoNcB%2Bwxyaes2813EzPwNqb%2Bo0oMH1J3GJ4jTXqUGYHShZochc1oAv1eTCmDRigPfewDUHbhiO4EwsiHBU5wC0vZiDR0CJe5AifF2ojB90LgQCPXoDwhKt89BgPSiu04fMADoSr5FfxobsKH8Hug8%2FBmAiRTaq5igEIwy6kP3QKspEKUuhVQ9RYAMTwHPA5Hnz6OYSXPEO4UWcYKfYbSaFQ%2BH36hIxVscmX3N474G5ALH6Z%2FchuPnGv3NSHePcN35F9gv540OtWv8ipI4cC%2Bqh9HDbYhwxPFTZYVwwb2ot5%2BHvZYLJrvYqWgtjc%2F2wyNCqNpj%2FnaDhxO8XtCFVuskyKJErxDciZzETnya%2BogOr5KcvSGN1X7FPV1lqt6n%2FKGh2%2Fr%2FgN2wH0IV2k6c8%2F2E540Db4IaecmTLkNOfII%2BaZ6HampW2oSIMH4hOEBlLOvqTJa9T%2BBKlidnKA3gedDA2YQXwUcAf4iAl9sZDq9gC%2BUt0bMi%2BBWUTpEaIbZt3DduHsWdmQApMzhjuJt1L%2FeNYuZXuGjG09pBrSsWA0UEwX0LhQREM78W2Tgt8vSfHjfRXffDqn2zIFAxnwj4HgfRa36SBTxemNu%2Fg%2FmyhdqxsWR84%2BtWGHD2lW80Ka9T4Do6v4DtjBdYx%2F8%2B7PJ%2F5qOl5SXNJnSVjXJ4n0MiVhX6skoPdwacJwrk8Y88sTxix%2BjjbwARchi2dgdeMWmuqQAe4wBq0dgxo06MsPQn3FINSkE1qND0KD1gPB0RNo9GgKpwB6MW%2FaDh77PJt6UFjEUUDSVkCyvbCIPDfxAgd%2BPdcYz9myILO1hkG2H6KXJIUN%2BzlOf8XwbcgBeq1mWve%2BrntWi%2FJlAazqwJdKvlZr8nUVs6powgPPYZRD0CxejUMiTjmUPbJV8XoSXSjAyJ0F741yDJ5c6qIZFnISxBqJRPhcqIYcfc0GLJ6ARV%2BEommbEhYtVY5Qe2BUT%2FEDHRS6JIoG5%2BMOQmUtBslE4Ii%2FBbuyEp0wk5KfAgSHRh6dZXwY8NgUHj0Zj6bXKR7lSQHDGOR7rHwt1xYdbks2flaX8jVsSZgfPhWMKvyduWAVsu4mF8xQuS0emu330AR%2BAHX%2BGZLBjup8LJRR3fWOziUz6vukfqfrlil0S5r%2BfWxqGU1TK13RXqYZhSwHhv8FQ9XRPO5Dev%2BtZYp2zWAZaMJstyrDv7WMM0Ouh2g60nD28EIb84Msnic%2BDAZGbzQ2uQ0dRLZxWIC0vRhdn2Mihl7bhcSgiMJrUOaKeK11HkdpWWiOOWmN9SJawU2iuWFDXU6ieQqtZMiyOWRDJWJiu39%2FW1prGcsmVH5QvJyNYNkbfFYarddA57ToFJkX4RSphs%2BDU1TZg2udIscRjXYjPlF3LpGpdIl%2BA70mzvvgFbE5lD45RaoatcEpasgpmiPs0Yc0m0KodrWaynr8oD6ZeVE%2BmRyq%2BzJZzlHhw9F67kQXpQE16XuimnQUxeGuqWhoQ2%2BtpeVJatzQ3%2BI1%2FG7weXk2jdfrm%2BcEuLYaKz7i9Rs9pNRzMK35W4IyQAv2k7%2Fq4xTttuU57e79fi0uDRGWiupyt9OZI1MOAWFQjrPlczK%2FaB1gOKUAkuUrJuqUiSqe31Z77xc%2FaqFcgnpSvzLwguCeccEReQDFcFOrHATSj5KGSIX7tFlEsYdPVSyS9Z34RvBE2HilF%2F0wrszZdKFZH50q6UI2CuV7p2ra0mlNGcqDv3UBhq3TXaZz%2F94xQKZJyCiSgBg6ujGfe418GYiaH0JWaLpl%2FAr%2BBjZ8uslhi3%2BO1gsJwSJU2ygjFd%2FubrXhx7UbPNXEm6oxe3VhHqqVZOmd7%2FYbHXdXvB4fEzr0DQdz0rpuULBTWKoBn9%2BabpCJPOoiXEcbmLnkybUcrRrcqD7j3lBEOkzVIKc9N8qVxDlM8131NJ9Jwhi7ebAqoiPdzPOZfWXC6t08H%2B7CtUxaOk2FaWair%2F2pPdMf1NKglg6ysB2pJUX12pB%2BUN2Fa9MPdDH94Lb%2FakkuFMMR%2BBAVTV9w%2FL08B%2Be58mxHoArwuZ7TUlejgaBuCkUrpvf2TVuonM776DWk5xuJ1ac%2FlUZiirl95eRee9TRe002AVgWQBvHM21LjAUtMALvPYPNzzi%2FqURkrzNxTphw2u5STcJl%2BSzO%2BQm4X1F%2Bc3vL7ycd7VTyLpnnm3Jr7v6YM7y5JGaMj7GAsApKVD6MTUEGM6J%2BbI%2FvEapuGReHSQ%2FTmE04QlRWKOygWklM4%2BmhMkpUPRkcxM3R2YdUw5B9UbPPRgoHLoBBsIB%2FqsEBDx48idGXDl5uxy%2BVgdLzvjJR9HBREsw%2FKooD7ObFgU85rbv2Sy4VRdQPqGwfcQyOHlroA8QmUx0Jl%2BoQGp4oRpQ5upXNUZ2hIz1SakMPUifCxVEcGIsDetAJ4TdAykLoKhKtGKJFUyC7tE50EKxvt6AC9Q2euZEG9Zr9AjDiSqEYbng5UCpezK5IeQKNY3gW227%2Fg6UEsIzpnGVxkSL%2BMiHmP%2BL3WkpOxkTB%2BpMLyadHE27GVeb7LpNF85QWHjxz5NPZ5LbJwvfbxZzffJPGsE3KnZUi5xs%2Bfpzd6hNUyo4BJgX3kYczQvLgMANk6KPQFoxx2dKyR51%2BhTC1ys9tMpmVMgWQjsViuzqpVa8etBcTsAtPxpQekPkD8YpAtYBXEAgQSXyAuqUtEIEICxSdp6MKHNGy4O%2F4uhN%2BmMuPbvePsVwAOJBaDxn58YRbDYLROzPiaCVK8AoCCFv%2BqNac8DQ0Yxjvhld50EIIDNIPZJ5OJKbhlgDABNRIswCNE0445v9qpTNhq1OUrAy%2FBIV8OT7ZV%2FUZfCg4cJECmZebLlKwfRZahQG3DzmnijOq6ZHYQcODZfxWEJdV7klkLRWJlL1sGn%2BU1ts4PAusDz1qL5edttclfqAwWAKwI6vE3CMoi5EP9fAJsb2zviEw1DMTgZw6%2F4HrSIjtTCCsKt8ZaGXcJX3VGG3bp%2FAt8ZI2Y8iZhTUetl6Vb33OXgZ60xx0pARAistZrF2BB8WZAgfpCwtKBI2n%2BQich7OzqEFjcSi6nxg95X7U16Uj1PeVDvBdv3xQzLYsBxV%2Bj15imN5Wtry8Ra7SIygQgc5gTvlYfJnzL6TS2QjcpUsjMOsuL8PD9T7i33EmiphVni4uRN2Js2eVo8aWIyYsU1FQvoc058Uy%2Fl7I1BjNR%2BRnglWrXba3dJwrT7vzSd%2FXKOZmqOp2CNr0xAQMi5JrcKJWZaO2VqLhupKgB%2FLTUyRsl%2FqypVq6tlMJy2mdOzk7BnHv3aGDkrgdWdyMWqQTeVN6U55dVAd%2FjMdBzEeLuUy2pyif6ZRC1pMr6%2F5IEz1YPf6c%2FXsxCPp4Qfs7Bd2pffbkMikxjirJmqZokwRSWF6Z08a2oBSnoE2jZAnTX5HQplmaRqt1guWM9iySdPYYvWebgt6IbgFpvsWzb9nrmpybZ69wyc01gQiSLHkZZcItwhS43bogZ5yalAlg8Yz%2BlKAG9s8oXERcgiMjR9dtvVU%2FoMTIb%2BgKw6CCkmG2hiXVgtB16PkGM9HDRZYnf0PMpETGPKLQNsm6%2FRxHs9KuMJvR7HuFGhCRB0%2Ba5dnqB81Hl1UOrD8Z63cOVD7mGGwb222kj1ZZDoCxhDmmCZJeDID2GkOwhUin4UIApPTQz5w0PPz9lBVF9nIKFpsYKnoVZH%2FVaZNKGLWnkeQRA50mqsAS%2BGRIvPENJrUv5ymWPJ%2FjXgEPpcCYkMrSK2ueDDT%2Bc4pqKRbJbBYDLdSHpPCaninLnA8AHChjcrNtox98twgODZZRATrxZjlbS8BpILvfk8cmvcCSZLXWADPgtR7xte6Vwu1NBMfVo0%2B1OPNgD2V7qJ8VrPX2UFHP3bE9lOvT5uowabc6LJ4l9H4Xp58qCtmuXSFR3O4IxvbOFl4Dtj6Y7fNVxU%2BD7bss26cAa7e2jzJGcihCi1QMhu84efsVJcNXr43kcDYt%2Bx%2FsXrvQ%2Bmh2T46nD%2FPdJ02AUkZwSjqpIG3udL47UMx%2FDqsrniDg0tSnrVg%2Fs9PlFS1LkubAVHTVTEV0JcHdTEUVUO6GqchSUFoOTEXVXfi6mIos2e7A3GrMcvM5WkJhSR7tBfMVbdcP4BlcVJagRVOgmtFulrCozyxFnXO9DJde2aUD4%2FARDjPW9Psm8ytY%2BB1VrqDR2iJWrmyZlDBi5S9ypRTyYmDtGuOQYNWgrO5VPgcfQtWpIwvVjvElqPek3LVUWLMvdlkZC%2Bac5%2FX0za7iJ3XhE38U%2FovLmWvrKodecmwvKafHKdZptFWx7Nbo4NwddHANM%2B3UdDYXdhIfFS2P%2FC3r1bb0eu8ytNGEXCXSkAiVj6TAjX%2FEKVVsRxSvNdqyCj4gjRYWq0j7RK%2FsdO6CQSM0pBEUEWlbFUhsTyHIiR1DIcXJzpGz0zvqtpBCTrkYCimaELQUNj5zIUUgC3rozScLuVT9ZihCQp1250B24obu3ISkrbK%2FrpB0p%2F3ZkssQfsDcnksOsZq6Jbayq3CCHGWINWitnRWrwihDrLj1Dw2vkvVWC3Dx%2F0Pnu6XVuY7ghMGDHZsOkfxygEPJ1MH4WpxxDv5f8uMT8F7w7%2F%2F5%2Fsfvd0UG%2F8FhXjYE6RmDE1voHI2KxHkMMqDCoZfyNEfP6BpPj7SXvvdMy0WK71RaknGuXI5xu42SXOhG1y8XyetYbrdhotexL9YucEpTPzn9gbFQ7hR3dGrIIF6l%2BJmCG6KgcWIhiD7TJFapURyxCgmLYeBUBoyrmKxkpYhbe1g4tIOwjFs%2FYi8RXCg8ElPlkehteSS2nM3VVf7PgXk5vGd%2B3swcmriElqYzNS576c6zXK02gwls%2FBnnCRAeogwoJ9fC%2Bnt%2FGk%2FRY2i2kwEeY2lcxpN%2BZ7hafdIT2io%2FCTfoPwnYTAb0ZvKKiG%2B7M6%2FIOjWvqJSNQruW7ZRHVWVGL%2Fxq5Lrmk1bsPSgBINZX2hFjzn3Sg%2BoHREZglRtIoX9s1YjItgEGrbZUkGph8%2FLAkyig5AW6P9v%2BjnK9%2FgQWogBGHhynCei7lYs6GBGtV6CRwSZi5gA70ANHdK9O94Dfi6JYrdF0Cpx9etrM1wV43N0UuIYPQFPEwI6ZD%2Bhk%2BMPUESdiUqCzbmfxSwb%2BWoNn3%2Fq3un23An7zKXbHruhURNSmIo9YKWjDbVHQckrf1lu7Up%2BimXhSlXT5ZLEu40W2HC8yGgr%2FXoscD9XFOl0z9mwylWNTjUZ7P6xgFSR2nQZ3bZmZYWC96pr16mDU7FuO2h7Dla1YK7gWKR%2B1qvmspYh2RQl%2BXxiu6KCsb6xEl0w5hHvmx6tsduQJ6V5g6coZrqrg9sGqnR1zsIf9Z%2FnYYQ%2FPznDlyNGugeHqNJHjjvkBzeF%2B9Au9s4XXgK2PZvsGtuPLt31nZ7hy5LDxwHB1inL6oEzHjhyqHhiuuoHWB7N77hnpcWj6B0ozcTQh%2F0N3fe2IBJCLT7kBX2472t58QQdk27SaG0PLYXfnxlTME3TDuePa50e7IQLdNO0PCXTU6S0e6Xdu4F0G2q190X5Wgilfnt5Co2eUabzXCuLccsChhwoWHLLgvKoX9ZGWqrHMsxp1UulDIIjrZBz5LjzyxFRAmlHG6K5s8Q7t8VYFPfAXmFKkKam7CPKuU4NSikHcCrbun6o8S6kAvPJsi6vPuQi3IVBQ9ZHKASg3pEJoK24rFWh7SqQTkGCU1R3gG1QUHvRVrbbJ9hfsZvszRZ16a56mVDvQms7ZtObFqzkocFHVbUdI%2B6u6rfG409nIktzOYrUHh9gPQSX2w910z6sl5eDnaVrSHNTkLpVSoyZt23BLXmLv1aR3fudyW%2FO01RC%2BZR6jIS5e9cK6LDokJ9EKmw7Z91e93XmT1t7upHdWRalaSe54RaliTmREbWwIvwdL46Btd2imGm1r6EazFNSU5EMc6RulG7Sni8EHnV8Zw%2BlrXhPv0MIXSoTfoAYMgn01YEUZd0caUA5NjhB4qqY4Ny%2FpiKBrZ2WkuvCRg1e2KdJkCWCAIKt1l9Owg8%2FHLK0m7yhY0FQ1je7h6QxgM8%2BgFdmqjDxaLb5mM6jWJ%2F8F)

### 1. å·¥ç¨‹ç»“æ„

```java
â””â”€â”€ src
    â”œâ”€â”€ main
    â”‚   â””â”€â”€ java
    â”‚      â””â”€â”€ pub.lhp.design.domain
    â”‚          â”œâ”€â”€ model
    â”‚          â”‚   â”œâ”€â”€ aggregates
    â”‚          â”‚   â”‚   â””â”€â”€ TreeRich.java
    â”‚          â”‚   â””â”€â”€ vo
    â”‚          â”‚       â”œâ”€â”€ EngineResult.java
    â”‚          â”‚       â”œâ”€â”€ TreeNode.java
    â”‚          â”‚       â”œâ”€â”€ TreeNodeLink.java    
    â”‚          â”‚       â””â”€â”€ TreeRoot.java	
    â”‚          â””â”€â”€ service
    â”‚              â”œâ”€â”€ engine
    â”‚              â”‚   â”œâ”€â”€ impl	
    â”‚              â”‚   â”‚   â””â”€â”€ TreeEngineHandle.java
    â”‚              â”‚   â”œâ”€â”€ EngineBase.java 
    â”‚              â”‚   â”œâ”€â”€ EngineConfig.java
    â”‚              â”‚   â””â”€â”€ IEngine.java	
    â”‚              â””â”€â”€ logic
    â”‚                  â”œâ”€â”€ impl	
    â”‚                  â”‚   â”œâ”€â”€ UserAgeFilter.java
    â”‚                  â”‚   â””â”€â”€ UserGenderFilter.java
    â”‚                  â””â”€â”€ LogicFilter.java	
    â””â”€â”€ test
         â””â”€â”€ java
             â””â”€â”€ pub.lhp.design.test
                 â””â”€â”€ ApiTest.java
```

### 2. æ¨¡å‹ç»“æ„

![[Pasted image 20241015113926.png]]

- é¦–å…ˆå¯ä»¥çœ‹ä¸‹é»‘è‰²æ¡†æ¡†çš„æ¨¡æ‹ŸæŒ‡å¯¼æ ‘ç»“æ„ï¼›`1`ã€`11`ã€`12`ã€`111`ã€`112`ã€`121`ã€`122`ï¼Œè¿™æ˜¯ä¸€ç»„æ ‘ç»“æ„çš„ IDï¼Œå¹¶ç”±èŠ‚ç‚¹ä¸²è”ç»„åˆå‡ºä¸€æ£µå…³ç³»æ ‘ã€‚
- æ¥ä¸‹æ¥æ˜¯ç±»å›¾éƒ¨åˆ†ï¼Œå·¦ä¾§æ˜¯ä» `LogicFilter` å¼€å§‹å®šä¹‰é€‚é…çš„å†³ç­–è¿‡æ»¤å™¨ï¼Œ`BaseLogic` æ˜¯å¯¹æ¥å£çš„å®ç°ï¼Œæä¾›æœ€åŸºæœ¬çš„é€šç”¨æ–¹æ³•ã€‚`UserAgeFilter`ã€`UserGenerFilter`ï¼Œæ˜¯ä¸¤ä¸ªå…·ä½“çš„å®ç°ç±»ç”¨äºåˆ¤æ–­ `å¹´é¾„` å’Œ `æ€§åˆ«`ã€‚
- æœ€ååˆ™æ˜¯å¯¹è¿™é¢—å¯ä»¥è¢«ç»„ç»‡å‡ºæ¥çš„å†³ç­–æ ‘ï¼Œè¿›è¡Œæ‰§è¡Œçš„å¼•æ“ã€‚åŒæ ·å®šä¹‰äº†å¼•æ“æ¥å£å’ŒåŸºç¡€çš„é…ç½®ï¼Œåœ¨é…ç½®é‡Œé¢è®¾å®šäº†éœ€è¦çš„æ¨¡å¼å†³ç­–èŠ‚ç‚¹ã€‚

### 3. ä»£ç å®ç°

#### 3.1 åŸºç¡€å¯¹è±¡

| åŒ…è·¯å¾„              | ç±»            | ä»‹ç»            |
| ---------------- | ------------ | ------------- |
| model.aggregates | TreeRich     | èšåˆå¯¹è±¡ï¼ŒåŒ…å«ç»„ç»‡æ ‘ä¿¡æ¯  |
| model.vo         | EngineResult | å†³ç­–è¿”å›å¯¹è±¡ä¿¡æ¯      |
| model.vo         | TreeNode     | æ ‘èŠ‚ç‚¹ï¼›å­å¶èŠ‚ç‚¹ã€æœå®èŠ‚ç‚¹ |
| model.vo         | TreeNodeLink | æ ‘èŠ‚ç‚¹é“¾æ¥é“¾è·¯       |
| model.vo         | TreeRoot     | æ ‘æ ¹ä¿¡æ¯          |

ä»¥ä¸Šè¿™éƒ¨åˆ†ç®€å•ä»‹ç»ï¼Œä¸åŒ…å«é€»è¾‘åªæ˜¯å„é¡¹å¿…è¦å±æ€§çš„ `get/set`ã€‚

#### 3.2 æ ‘èŠ‚ç‚¹é€»è¾‘è¿‡æ»¤å™¨æ¥å£

- è¿™ä¸€éƒ¨åˆ†å®šä¹‰äº†é€‚é…çš„é€šç”¨æ¥å£ï¼Œé€»è¾‘å†³ç­–å™¨ã€è·å–å†³ç­–å€¼ï¼Œè®©æ¯ä¸€ä¸ªæä¾›å†³ç­–èƒ½åŠ›çš„èŠ‚ç‚¹éƒ½å¿…é¡»å®ç°æ­¤æ¥å£ï¼Œä¿è¯ç»Ÿä¸€æ€§ã€‚

```java
public interface LogicFilter {

    /**
     * é€»è¾‘å†³ç­–å™¨
     *
     * @param matterValue          å†³ç­–å€¼
     * @param treeNodeLineInfoList å†³ç­–èŠ‚ç‚¹
     * @return ä¸‹ä¸€ä¸ªèŠ‚ç‚¹Id
     */
    Long filter(String matterValue, List<TreeNodeLink> treeNodeLineInfoList);

    /**
     * è·å–å†³ç­–å€¼
     *
     * @param decisionMatter å†³ç­–ç‰©æ–™
     * @return å†³ç­–å€¼
     */
    String matterValue(Long treeId, String userId, Map<String, String> decisionMatter);

}
```

#### 3.3 å†³ç­–æŠ½è±¡ç±»æä¾›åŸºç¡€æœåŠ¡

- åœ¨æŠ½è±¡æ–¹æ³•ä¸­å®ç°äº†æ¥å£æ–¹æ³•ï¼ŒåŒæ—¶å®šä¹‰äº†åŸºæœ¬çš„å†³ç­–æ–¹æ³•ï¼›`1ã€2ã€3ã€4ã€5`ï¼Œ`ç­‰äºã€å°äºã€å¤§äºã€å°äºç­‰äºã€å¤§äºç­‰äº` çš„åˆ¤æ–­é€»è¾‘ã€‚
- åŒæ—¶å®šä¹‰äº†æŠ½è±¡æ–¹æ³•ï¼Œè®©æ¯ä¸€ä¸ªå®ç°æ¥å£çš„ç±»éƒ½å¿…é¡»æŒ‰ç…§è§„åˆ™æä¾› `å†³ç­–å€¼`ï¼Œè¿™ä¸ªå†³ç­–å€¼ç”¨äºåšé€»è¾‘æ¯”å¯¹ã€‚

```java
public abstract class BaseLogic implements LogicFilter {

    @Override
    public Long filter(String matterValue, List<TreeNodeLink> treeNodeLinkList) {
        for (TreeNodeLink nodeLine : treeNodeLinkList) {
            if (decisionLogic(matterValue, nodeLine)) return nodeLine.getNodeIdTo();
        }
        return 0L;
    }

    @Override
    public abstract String matterValue(Long treeId, String userId, Map<String, String> decisionMatter);

    private boolean decisionLogic(String matterValue, TreeNodeLink nodeLink) {
        switch (nodeLink.getRuleLimitType()) {
            case 1:
                return matterValue.equals(nodeLink.getRuleLimitValue());
            case 2:
                return Double.parseDouble(matterValue) > Double.parseDouble(nodeLink.getRuleLimitValue());
            case 3:
                return Double.parseDouble(matterValue) < Double.parseDouble(nodeLink.getRuleLimitValue());
            case 4:
                return Double.parseDouble(matterValue) <= Double.parseDouble(nodeLink.getRuleLimitValue());
            case 5:
                return Double.parseDouble(matterValue) >= Double.parseDouble(nodeLink.getRuleLimitValue());
            default:
                return false;
        }
    }

}
```

#### 3.4 æ ‘èŠ‚ç‚¹é€»è¾‘å®ç°ç±»

å¹´é¾„èŠ‚ç‚¹

```java
public class UserAgeFilter extends BaseLogic {

    @Override
    public String matterValue(Long treeId, String userId, Map<String, String> decisionMatter) {
        return decisionMatter.get("age");
    }

}
```

æ€§åˆ«èŠ‚ç‚¹

```java
public class UserGenderFilter extends BaseLogic {

    @Override
    public String matterValue(Long treeId, String userId, Map<String, String> decisionMatter) {
        return decisionMatter.get("gender");
    }

}
```

- ä»¥ä¸Šä¸¤ä¸ªå†³ç­–é€»è¾‘çš„èŠ‚ç‚¹è·å–å€¼çš„æ–¹å¼éƒ½éå¸¸ç®€å•ï¼Œåªæ˜¯è·å–ç”¨æˆ·çš„å…¥å‚å³å¯ã€‚å®é™…çš„ä¸šåŠ¡å¼€å‘å¯ä»¥ä»æ•°æ®åº“ã€RPC æ¥å£ã€ç¼“å­˜è¿ç®—ç­‰å„ç§æ–¹å¼è·å–ã€‚

#### 3.5 å†³ç­–å¼•æ“æ¥å£å®šä¹‰

- å¯¹äºä½¿ç”¨æ–¹æ¥è¯´ä¹ŸåŒæ ·éœ€è¦å®šä¹‰ç»Ÿä¸€çš„æ¥å£æ“ä½œï¼Œè¿™æ ·çš„å¥½å¤„éå¸¸æ–¹ä¾¿åç»­æ‹“å±•å‡ºä¸åŒç±»å‹çš„å†³ç­–å¼•æ“ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å»ºé€ ä¸åŒçš„å†³ç­–å·¥å‚ã€‚

```java
public interface IEngine {

    EngineResult process(final Long treeId, final String userId, TreeRich treeRich, final Map<String, String> decisionMatter);

}
```

#### 3.6 å†³ç­–èŠ‚ç‚¹é…ç½®

```java
public class EngineConfig {

    static Map<String, LogicFilter> logicFilterMap;

    static {
        logicFilterMap = new ConcurrentHashMap<>();
        logicFilterMap.put("userAge", new UserAgeFilter());
        logicFilterMap.put("userGender", new UserGenderFilter());
    }

    public Map<String, LogicFilter> getLogicFilterMap() {
        return logicFilterMap;
    }

    public void setLogicFilterMap(Map<String, LogicFilter> logicFilterMap) {
        this.logicFilterMap = logicFilterMap;
    }

}
```

- åœ¨è¿™é‡Œå°†å¯æä¾›æœåŠ¡çš„å†³ç­–èŠ‚ç‚¹é…ç½®åˆ° `map` ç»“æ„ä¸­ï¼Œå¯¹äºè¿™æ ·çš„ `map` ç»“æ„å¯ä»¥æŠ½å–åˆ°æ•°æ®åº“ä¸­ï¼Œé‚£ä¹ˆå°±å¯ä»¥éå¸¸æ–¹ä¾¿çš„ç®¡ç†ã€‚

#### 3.7 åŸºç¡€å†³ç­–å¼•æ“åŠŸèƒ½

```java
public abstract class EngineBase extends EngineConfig implements IEngine {

    private Logger logger = LoggerFactory.getLogger(EngineBase.class);

    @Override
    public abstract EngineResult process(Long treeId, String userId, TreeRich treeRich, Map<String, String> decisionMatter);

    protected TreeNode engineDecisionMaker(TreeRich treeRich, Long treeId, String userId, Map<String, String> decisionMatter) {
        TreeRoot treeRoot = treeRich.getTreeRoot();
        Map<Long, TreeNode> treeNodeMap = treeRich.getTreeNodeMap();
        // è§„åˆ™æ ‘æ ¹ID
        Long rootNodeId = treeRoot.getTreeRootNodeId();
        TreeNode treeNodeInfo = treeNodeMap.get(rootNodeId);
        //èŠ‚ç‚¹ç±»å‹[NodeType]ï¼›1å­å¶ã€2æœå®
        while (treeNodeInfo.getNodeType().equals(1)) {
            String ruleKey = treeNodeInfo.getRuleKey();
            LogicFilter logicFilter = logicFilterMap.get(ruleKey);
            String matterValue = logicFilter.matterValue(treeId, userId, decisionMatter);
            Long nextNode = logicFilter.filter(matterValue, treeNodeInfo.getTreeNodeLinkList());
            treeNodeInfo = treeNodeMap.get(nextNode);
            logger.info("å†³ç­–æ ‘å¼•æ“=>{} userIdï¼š{} treeIdï¼š{} treeNodeï¼š{} ruleKeyï¼š{} matterValueï¼š{}", treeRoot.getTreeName(), userId, treeId, treeNodeInfo.getTreeNodeId(), ruleKey, matterValue);
        }
        return treeNodeInfo;
    }

}
```

- è¿™é‡Œä¸»è¦æä¾›å†³ç­–æ ‘æµç¨‹çš„å¤„ç†è¿‡ç¨‹ï¼Œæœ‰ç‚¹åƒé€šè¿‡é“¾è·¯çš„å…³ç³»ï¼ˆæ€§åˆ«ã€å¹´é¾„ï¼‰åœ¨äºŒå‰æ ‘ä¸­å¯»æ‰¾æœå®èŠ‚ç‚¹çš„è¿‡ç¨‹ã€‚
- åŒæ—¶æä¾›ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œæ‰§è¡Œå†³ç­–æµç¨‹çš„æ–¹æ³•ä¾›å¤–éƒ¨å»åšå…·ä½“çš„å®ç°ã€‚

#### 3.8 å†³ç­–å¼•æ“çš„å®ç°

```java
public class TreeEngineHandle extends EngineBase {

    @Override
    public EngineResult process(Long treeId, String userId, TreeRich treeRich, Map<String, String> decisionMatter) {
        // å†³ç­–æµç¨‹
        TreeNode treeNode = engineDecisionMaker(treeRich, treeId, userId, decisionMatter);
        // å†³ç­–ç»“æœ
        return new EngineResult(userId, treeId, treeNode.getTreeNodeId(), treeNode.getNodeValue());
    }

}
```

- è¿™é‡Œå¯¹äºå†³ç­–å¼•æ“çš„å®ç°å°±éå¸¸ç®€å•äº†ï¼Œé€šè¿‡ä¼ é€’è¿›æ¥çš„å¿…è¦ä¿¡æ¯ï¼šå†³ç­–æ ‘ä¿¡æ¯ã€å†³ç­–ç‰©æ–™å€¼ï¼Œæ¥åšå…·ä½“çš„æ ‘å½¢ç»“æ„å†³ç­–ã€‚

### 4. æµ‹è¯•éªŒè¯

#### 4.1 ç»„è£…æ ‘å…³ç³»

```java
@Before
public void init() {
    // èŠ‚ç‚¹ï¼š1
    TreeNode treeNode_01 = new TreeNode();
    treeNode_01.setTreeId(10001L);
    treeNode_01.setTreeNodeId(1L);
    treeNode_01.setNodeType(1);
    treeNode_01.setNodeValue(null);
    treeNode_01.setRuleKey("userGender");
    treeNode_01.setRuleDesc("ç”¨æˆ·æ€§åˆ«[ç”·/å¥³]");
    // é“¾æ¥ï¼š1->11
    TreeNodeLink treeNodeLink_11 = new TreeNodeLink();
    treeNodeLink_11.setNodeIdFrom(1L);
    treeNodeLink_11.setNodeIdTo(11L);
    treeNodeLink_11.setRuleLimitType(1);
    treeNodeLink_11.setRuleLimitValue("man");
    // é“¾æ¥ï¼š1->12
    TreeNodeLink treeNodeLink_12 = new TreeNodeLink();
    treeNodeLink_12.setNodeIdTo(1L);
    treeNodeLink_12.setNodeIdTo(12L);
    treeNodeLink_12.setRuleLimitType(1);
    treeNodeLink_12.setRuleLimitValue("woman");
    List<TreeNodeLink> treeNodeLinkList_1 = new ArrayList<>();
    treeNodeLinkList_1.add(treeNodeLink_11);
    treeNodeLinkList_1.add(treeNodeLink_12);
    treeNode_01.setTreeNodeLinkList(treeNodeLinkList_1);
    // èŠ‚ç‚¹ï¼š11
    TreeNode treeNode_11 = new TreeNode();
    treeNode_11.setTreeId(10001L);
    treeNode_11.setTreeNodeId(11L);
    treeNode_11.setNodeType(1);
    treeNode_11.setNodeValue(null);
    treeNode_11.setRuleKey("userAge");
    treeNode_11.setRuleDesc("ç”¨æˆ·å¹´é¾„");
    // é“¾æ¥ï¼š11->111
    TreeNodeLink treeNodeLink_111 = new TreeNodeLink();
    treeNodeLink_111.setNodeIdFrom(11L);
    treeNodeLink_111.setNodeIdTo(111L);
    treeNodeLink_111.setRuleLimitType(3);
    treeNodeLink_111.setRuleLimitValue("25");
    // é“¾æ¥ï¼š11->112
    TreeNodeLink treeNodeLink_112 = new TreeNodeLink();
    treeNodeLink_112.setNodeIdFrom(11L);
    treeNodeLink_112.setNodeIdTo(112L);
    treeNodeLink_112.setRuleLimitType(5);
    treeNodeLink_112.setRuleLimitValue("25");
    List<TreeNodeLink> treeNodeLinkList_11 = new ArrayList<>();
    treeNodeLinkList_11.add(treeNodeLink_111);
    treeNodeLinkList_11.add(treeNodeLink_112);
    treeNode_11.setTreeNodeLinkList(treeNodeLinkList_11);
    // èŠ‚ç‚¹ï¼š12
    TreeNode treeNode_12 = new TreeNode();
    treeNode_12.setTreeId(10001L);
    treeNode_12.setTreeNodeId(12L);
    treeNode_12.setNodeType(1);
    treeNode_12.setNodeValue(null);
    treeNode_12.setRuleKey("userAge");
    treeNode_12.setRuleDesc("ç”¨æˆ·å¹´é¾„");
    // é“¾æ¥ï¼š12->121
    TreeNodeLink treeNodeLink_121 = new TreeNodeLink();
    treeNodeLink_121.setNodeIdFrom(12L);
    treeNodeLink_121.setNodeIdTo(121L);
    treeNodeLink_121.setRuleLimitType(3);
    treeNodeLink_121.setRuleLimitValue("25");
    // é“¾æ¥ï¼š12->122
    TreeNodeLink treeNodeLink_122 = new TreeNodeLink();
    treeNodeLink_122.setNodeIdFrom(12L);
    treeNodeLink_122.setNodeIdTo(122L);
    treeNodeLink_122.setRuleLimitType(5);
    treeNodeLink_122.setRuleLimitValue("25");
    List<TreeNodeLink> treeNodeLinkList_12 = new ArrayList<>();
    treeNodeLinkList_12.add(treeNodeLink_121);
    treeNodeLinkList_12.add(treeNodeLink_122);
    treeNode_12.setTreeNodeLinkList(treeNodeLinkList_12);
    // èŠ‚ç‚¹ï¼š111
    TreeNode treeNode_111 = new TreeNode();
    treeNode_111.setTreeId(10001L);
    treeNode_111.setTreeNodeId(111L);
    treeNode_111.setNodeType(2);
    treeNode_111.setNodeValue("æœå®A");
    // èŠ‚ç‚¹ï¼š112
    TreeNode treeNode_112 = new TreeNode();
    treeNode_112.setTreeId(10001L);
    treeNode_112.setTreeNodeId(112L);
    treeNode_112.setNodeType(2);
    treeNode_112.setNodeValue("æœå®B");
    // èŠ‚ç‚¹ï¼š121
    TreeNode treeNode_121 = new TreeNode();
    treeNode_121.setTreeId(10001L);
    treeNode_121.setTreeNodeId(121L);
    treeNode_121.setNodeType(2);
    treeNode_121.setNodeValue("æœå®C");
    // èŠ‚ç‚¹ï¼š122
    TreeNode treeNode_122 = new TreeNode();
    treeNode_122.setTreeId(10001L);
    treeNode_122.setTreeNodeId(122L);
    treeNode_122.setNodeType(2);
    treeNode_122.setNodeValue("æœå®D");
    // æ ‘æ ¹
    TreeRoot treeRoot = new TreeRoot();
    treeRoot.setTreeId(10001L);
    treeRoot.setTreeRootNodeId(1L);
    treeRoot.setTreeName("è§„åˆ™å†³ç­–æ ‘");
    Map<Long, TreeNode> treeNodeMap = new HashMap<>();
    treeNodeMap.put(1L, treeNode_01);
    treeNodeMap.put(11L, treeNode_11);
    treeNodeMap.put(12L, treeNode_12);
    treeNodeMap.put(111L, treeNode_111);
    treeNodeMap.put(112L, treeNode_112);
    treeNodeMap.put(121L, treeNode_121);
    treeNodeMap.put(122L, treeNode_122);
    treeRich = new TreeRich(treeRoot, treeNodeMap);
}
```

![[Pasted image 20241015220706.png]]

![[Pasted image 20241015125847.png]]

- **é‡è¦**ï¼Œè¿™ä¸€éƒ¨åˆ†æ˜¯ç»„åˆæ¨¡å¼éå¸¸é‡è¦çš„ä½¿ç”¨ï¼Œåœ¨æˆ‘ä»¬å·²ç»å»ºé€ å¥½çš„å†³ç­–æ ‘å…³ç³»ä¸‹ï¼Œå¯ä»¥åˆ›å»ºå‡ºæ ‘çš„å„ä¸ªèŠ‚ç‚¹ï¼Œä»¥åŠå¯¹èŠ‚ç‚¹é—´ä½¿ç”¨é“¾è·¯è¿›è¡Œä¸²è”ã€‚
- å³ä½¿åç»­ä½ éœ€è¦åšä»»ä½•ä¸šåŠ¡çš„æ‰©å±•éƒ½å¯ä»¥åœ¨é‡Œé¢æ·»åŠ ç›¸åº”çš„èŠ‚ç‚¹ï¼Œå¹¶åšåŠ¨æ€åŒ–çš„é…ç½®ã€‚
- å…³äºè¿™éƒ¨åˆ†æ‰‹åŠ¨ç»„åˆçš„æ–¹å¼å¯ä»¥æå–åˆ°æ•°æ®åº“ä¸­ï¼Œé‚£ä¹ˆä¹Ÿå°±å¯ä»¥æ‰©å±•åˆ°å›¾å½¢ç•Œé¢çš„è¿›è¡Œé…ç½®æ“ä½œã€‚

#### 3.2 ç¼–å†™æµ‹è¯•ç±»

```java
@Test
public void test_tree() {
    logger.info("å†³ç­–æ ‘ç»„åˆç»“æ„ä¿¡æ¯ï¼š\r\n" + JSON.toJSONString(treeRich));
    
    IEngine treeEngineHandle = new TreeEngineHandle();
    Map<String, String> decisionMatter = new HashMap<>();
    decisionMatter.put("gender", "man");
    decisionMatter.put("age", "29");
    
    EngineResult result = treeEngineHandle.process(10001L, "Oli09pLkdjh", treeRich, decisionMatter);
    
    logger.info("æµ‹è¯•ç»“æœï¼š{}", JSON.toJSONString(result));
}
```

- åœ¨è¿™é‡Œæä¾›äº†è°ƒç”¨çš„é€šè¿‡ç»„ç»‡æ¨¡å¼åˆ›å»ºå‡ºæ¥çš„æµç¨‹å†³ç­–æ ‘ï¼Œè°ƒç”¨çš„æ—¶å€™ä¼ å…¥äº†å†³ç­–æ ‘çš„ IDï¼Œé‚£ä¹ˆå¦‚æœæ˜¯ä¸šåŠ¡å¼€å‘ä¸­å°±å¯ä»¥æ–¹ä¾¿çš„è§£è€¦å†³ç­–æ ‘ä¸ä¸šåŠ¡çš„ç»‘å®šå…³ç³»ï¼ŒæŒ‰éœ€ä¼ å…¥å†³ç­–æ ‘ ID å³å¯ã€‚
- æ­¤å¤–å…¥å‚æˆ‘ä»¬è¿˜æä¾›äº†éœ€è¦å¤„ç†ï¼›`ç”·`(man)ã€`å¹´é¾„`(29 å²)ï¼Œçš„å‚æ•°ä¿¡æ¯ã€‚

#### 4.3 æµ‹è¯•ç»“æœ

```java
23:35:05.711 [main] INFO  o.i.d.d.d.service.engine.EngineBase - å†³ç­–æ ‘å¼•æ“=>è§„åˆ™å†³ç­–æ ‘ userIdï¼šOli09pLkdjh treeIdï¼š10001 treeNodeï¼š11 ruleKeyï¼šuserGender matterValueï¼šman
23:35:05.712 [main] INFO  o.i.d.d.d.service.engine.EngineBase - å†³ç­–æ ‘å¼•æ“=>è§„åˆ™å†³ç­–æ ‘ userIdï¼šOli09pLkdjh treeIdï¼š10001 treeNodeï¼š112 ruleKeyï¼šuserAge matterValueï¼š29
23:35:05.715 [main] INFO  org.itstack.demo.design.test.ApiTest - æµ‹è¯•ç»“æœï¼š{"nodeId":112,"nodeValue":"æœå®B","success":true,"treeId":10001,"userId":"Oli09pLkdjh"}

Process finished with exit code 0
```

## å…­ã€æ€»ç»“

- ä»ä»¥ä¸Šçš„å†³ç­–æ ‘åœºæ™¯æ¥çœ‹ï¼Œç»„åˆæ¨¡å¼ä¸»è¦è§£å†³çš„æ˜¯ä¸€ç³»åˆ—ç®€å•é€»è¾‘èŠ‚ç‚¹æˆ–è€…æ‰©å±•çš„å¤æ‚é€»è¾‘èŠ‚ç‚¹åœ¨ä¸åŒç»“æ„çš„ç»„ç»‡ä¸‹ï¼Œå¯¹äºå¤–éƒ¨çš„è°ƒç”¨æ˜¯ä»ç„¶å¯ä»¥éå¸¸ç®€å•çš„ã€‚
- è¿™éƒ¨åˆ†è®¾è®¡æ¨¡å¼ä¿è¯äº†å¼€é—­åŸåˆ™ï¼Œæ— éœ€æ›´æ”¹æ¨¡å‹ç»“æ„ä½ å°±å¯ä»¥æä¾›æ–°çš„é€»è¾‘èŠ‚ç‚¹çš„ä½¿ç”¨å¹¶é…åˆç»„ç»‡å‡ºæ–°çš„å…³ç³»æ ‘ã€‚ä½†å¦‚æœæ˜¯ä¸€äº›åŠŸèƒ½å·®å¼‚åŒ–éå¸¸å¤§çš„æ¥å£è¿›è¡ŒåŒ…è£…å°±ä¼šå˜å¾—æ¯”è¾ƒå›°éš¾ï¼Œä½†ä¹Ÿä¸æ˜¯ä¸èƒ½å¾ˆå¥½çš„å¤„ç†ï¼Œåªä¸è¿‡éœ€è¦åšä¸€äº›é€‚é…å’Œç‰¹å®šåŒ–çš„å¼€å‘ã€‚
- å¾ˆå¤šæ—¶å€™å› ä¸ºä½ çš„æè‡´è¿½æ±‚å’Œç¨æœ‰å€”å¼ºçš„å·¥åŒ ç²¾ç¥ï¼Œå³ä½¿åœ¨é¢å¯¹åŒæ ·çš„ä¸šåŠ¡éœ€æ±‚ï¼Œä½ èƒ½å®Œæˆå‡ºæœ€å¥½çš„ä»£ç ç»“æ„å’Œæœ€æ˜“äºæ‰©å±•çš„æŠ€æœ¯æ¶æ„ã€‚`ä¸è¦è¢«è¿œä¸èƒ½ç»™ä½ æŒ‡å¯¼æå‡èƒ½åŠ›çš„å½±å“åˆ°æ”¾å¼ƒè‡ªå·±çš„è¿½æ±‚ï¼`
